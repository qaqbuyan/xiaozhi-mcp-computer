# xiaozhi-mcp-computer
一个控制电脑的接口集合，用于通过自行扩展AI能力

## 视频展示（v0.1.7-beta）
https://www.bilibili.com/video/BV19x3bz7E8z/

&emsp;

## 使用说明

    - 指令运行
        1. 安装依赖:
            pip install -r requirements.txt

        3. 修改配置:
            config.yaml 中修改配置，比如端口等

        4. 启动服务:
            python mcp_pipe.py aggregate.py

    - 打包运行（Windows）
        1. 依赖:
            如果之前从未使用过该应用或者打包版本低于 0.2.2-beta ，需要先安装 Python 以及依赖：
            pip install -r requirements.txt
            否则可以直接使用该应用的打包版本，在其 0.2.2-beta 之后的版本中已经包含了所有的依赖的自动安装，无需手动安装

        2. 下载:
            v0.2.1-beta版本之前可以通过 [tags](https://github.com/qaqbuyan/xiaozhi-mcp-computer/tags) 下载
            v0.2.1-beta版本之后可以通过 询问小智 ’获取客户端版本信息‘ 得到打包程序下载链接，可以让它帮你下载，也可以自行下载

        3. 运行:
            xiaozhi-mcp-computer.exe

- 注意事项
    - 该项目需要使用 Python 3.13 以上版本
    - 如果需要使用 播放音乐 功能，需要自建 API，可以参考 [点歌](https://github.com/qaqbuyan/xiaozhi-esp32-qq-music)
    中关于 项目结构 中的 配套的音乐源代码

&emsp;

## 自带功能

- 播放音乐
    - 点歌
    - 顺序（随机）播放歌单（腾讯）
    - 继续播放
    - 停止播放
    - 切换播放模式（循环/随机/顺序）
    - 调整音量（增加/减少/设置）
- 自动化
    - 输入文字
    - 移动鼠标到页面（屏幕）上的某个文字位置
    - 文档
        - Word
        - Excel
- 图像文字坐标识别
- 浏览器书签
    - 获取
    - 打开
- 打开桌面
- 打开网站
- 文件操作
    - 打开文件（文件夹）
    - 新建文件（文件夹）
    - 复制文件（文件夹）
    - 移动文件（文件夹）
    - 剪切文件（文件夹）
    - 粘贴文件（文件夹）
    - 删除文件（文件夹）
    - 重命名文件（文件夹）
    - 查找文件（文件夹）
    - 查看文件（文件夹）属性（内容）
- 网络操作
    - 下载文件
- 应用
    - 打开应用
    - 关闭应用
- 截图保存
- 清空回收站
- 按键模拟
    - 鼠标模拟
        - 点击
            - 左键
            - 右键
            - 中键
            - 前键
            - 后键
        - 长按
            - 左键
            - 右键
            - 中键
        - 移动
            - 滚轮上下
            - 指针左右
            - 移动到指定区域
    - 键盘模拟
        - 长按
        - 输入
        - 组合键
- 记事本写入
- 获取系统信息
- 获取系统剪贴板
    - 文字
    - 图片
- 电脑扬声器
    - 获取（程序）音量
    - 设置（程序）音量

&emsp;

## 创建自己的MCP工具

这里简单的说明一下如何创建自己的MCP工具

### 工具的创建
    - 根据 utils 文件夹中的功能代码做参考，创建自己的工具，然后在 register.py 中添加到 注册 列表中即可
    - 工具命名以 功能_渠道区分，比如我的写入记事本的工具为 write_to_notepad 表明是写入记事本
    - 工具的名字和参数的命名一定要清晰的让大模型知道它的作用，尽量不要用缩写
    - 不然大模型可能不知道它的作用而无法正常调用该工具进行工作，同时提供一段注释来说明工具的作用以及在何时使用
    - 函数内的文档注释（使用"""..."""引用的部分）引导大模型何时使用该工具
    - 比如
        ```python
        def write_to_notepad(content: str):
            """
            写入内容到记事本
            :param content: 要写入的内容
            :return: 写入成功返回 True，否则返回 False
            """
        ```
    - 工具参数的类型要清晰的告诉大模型它的作用，如果有参数的名称也要清晰的告诉大模型它的作用，比如 content 表示要写入的内容
    - 另外写好类型，比如 str 表示字符串，int 表示整数，list 表示列表，dict 表示字典等
    - 这样大模型才能正确的调用该工具，否则可能会出现调用失败的情况
    - 工具的参数要尽可能的详细，比如字符串类型的参数，要尽可能的详细的告诉大模型它的作用

### 工具的调用
    工具的调用需要在 aggregate.py（管道服务）中进行，在 register.py（集中注册） 中找到 register 函数
    - 在该函数中添加自己的工具，比如我的写入记事本的工具为 write_to_notepad
    - 那么在 register 函数中添加如下代码
    ```python
    from utils.write_to_notepad import write_to_notepad
    ```
    - 然后在 register 函数中添加如下代码
    ```python
    write_to_notepad(mcp)
    ```
    - 这样大模型就可以调用自己的工具了

### 工具的测试
    工具的测试需要在 mcp_pipe.py（管道代理）中进行调用 aggregate.py（管道服务）
    - 执行工具测试
    ```python
    python mcp_pipe.py aggregate.py
    ```
    ## 工具测试的结果
    - 如果报错，说明工具测试失败，需要检查工具的代码是否正确，再次执行工具测试
    - 如果没有报错，说明工具测试成功
    - 如果工具测试成功，那么大模型就可以调用自己的工具了
    - 对话中调用该工具，比如我在大模型的对话中输入 记事本写入 hello world
    - 那么大模型就会调用我的写入记事本的工具，将 hello world 写入记事本
    - 如果大模型调用失败，可能是因为工具的代码（注释）有问题，请检查工具的代码是否符合上面的 工具的创建 要求
    - 一般来说，大模型调用失败的原因有以下几种
        - 工具的参数命名有问题，比如参数的类型不正确，参数的名称不正确，参数的描述不正确，函数的返回值不正确等
        - 工具的函数命名不正确，导致大模型无法找到该工具（这个问题命名格式正确的话一般不会出现，因为工具的命名是根据功能和渠道区分的，比如我的写入记事本的工具为 write_to_notepad 表明是写入记事本）
    - 如果大模型调用成功，那么大模型就可以正常的使用自己的工具了

&emsp;

## 如果代码能帮助到你，欢迎给个star